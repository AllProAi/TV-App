<!-- Generated by SpecStory -->

# Continuing Handoff Documentation (2025-05-17 01:02:41)

_**User**_

\@2-handoff.md continue

---

_**Assistant**_



---

## Code Organization

### Repository Structure
```
/
├── backend/
│   ├── services/
│   │   ├── whisperService.js
│   │   ├── gptService.js
│   │   └── sessionService.js
│   ├── routes/
│   ├── socket/
│   │   ├── tvNamespace.js
│   │   ├── mobileNamespace.js
│   │   └── subtitleNamespace.js
│   └── index.js
├── tv-app/
│   ├── player/
│   ├── subtitles/
│   ├── pairing/
│   └── ui/
└── mobile-app/
    ├── remote/
    ├── voice/
    ├── chat/
    ├── pairing/
    └── connection/
```

## API Documentation

### WebSocket Events

#### TV Namespace Events
- `connect`: Initial connection from TV app
- `register`: Register new TV session
- `subtitle-chunk`: Process and display new subtitle
- `execute-command`: Execute remote command
- `disconnect`: Handle TV disconnect

#### Mobile Namespace Events
- `pair`: Pair mobile with TV using session code
- `send-command`: Send remote control command
- `voice-command`: Process voice recording
- `query`: Send content query to AI
- `disconnect`: Handle mobile disconnect

### REST API Endpoints
- `POST /api/session/create`: Create new viewing session
- `GET /api/session/:id`: Get session information
- `POST /api/transcribe`: Submit audio for transcription
- `POST /api/query`: Submit content query

## Security Considerations

1. **API Key Protection**: Server-side only usage of OpenAI keys
2. **Session Validation**: JWT-based validation for all socket connections
3. **Input Sanitization**: All user inputs sanitized before processing
4. **Rate Limiting**: Implemented on all API endpoints
5. **CORS Configuration**: Restricted to allowed origins
6. **Data Minimization**: Only essential data stored in session

## Troubleshooting Guide

### Common Issues

1. **Subtitle Delay**
   - Check network latency between components
   - Verify OpenAI API responsiveness
   - Check subtitle processing queue

2. **Pairing Failures**
   - Ensure both devices on same network
   - Verify QR code scanning accuracy
   - Check session service for errors

3. **Voice Command Issues**
   - Verify microphone permissions
   - Check audio quality and background noise
   - Validate WebSocket connection stability

## Performance Monitoring

1. **Key Metrics**
   - API response times
   - WebSocket connection stability
   - Subtitle processing latency
   - Voice command recognition accuracy

2. **Logging Strategy**
   - Structured logging with correlation IDs
   - Error aggregation with context
   - Performance metrics collection

## Developer Onboarding

1. **Local Development Setup**
   - Clone repository
   - Run `pnpm install` in each component directory
   - Configure `.env` file with required variables
   - Run `node dev.js` to start all components

2. **Development Workflow**
   - Feature branches from `develop`
   - PR reviews required before merge
   - Linting and formatting using ESLint and Prettier
   - Test locally before submission

3. **Resources**
   - Socket.io documentation: https://socket.io/docs/v4/
   - ShakaPlayer documentation: https://shaka-player-demo.appspot.com/docs/api/index.html
   - OpenAI API reference: https://platform.openai.com/docs/api-reference

---

_**User**_

hey there thanks for signing up to
0:03
participate in the Senza hackathon we
0:05
are really looking forward to welcoming
0:07
you to Hacker Dojo the weekend of May
0:11
16th through 18th we're going to get
0:14
together and build some apps that run on
0:16
Cine Media Senza our new cloud-based
0:19
video streaming platform that runs web
0:22
apps in the cloud and then streams the
0:25
interface to your TV using a little
0:28
device that we call a cloud connector so
0:32
want to give you a little rundown of the
0:34
agenda we're going to get together after
0:36
work on Friday afternoon the 16th of May
0:39
at 5:00 pm we're going to do some intros
0:43
uh some ideation and team formation to
0:46
help kick off the whole uh event then on
0:50
Saturday the whole day is going to be
0:51
devoted to hacking we'll make sure to
0:53
have some great food and drinks for you
0:56
and then on Sunday we're going to wrap
0:58
up development and get everything
1:00
submitted by 11:00 a.m we'll do some
1:03
judging and then have the prizes and
1:07
awards so before you come to the event
1:10
there's a few things that you can do to
1:12
get started uh one of them is checking
1:14
out our developer portal which has got
1:17
lots of information there's a quick
1:19
start guide uh some app integration
1:22
guides some sample code and tutorials
1:25
lots of great stuff in there if you like
1:28
uh learning from watching videos which I
1:31
assume you do because you're watching
1:32
this one uh we've got a whole YouTube
1:35
channel full of video
1:37
tutorials um a few other things you can
1:40
do you can join our Slack environment
1:42
which we're going to be using for
1:43
chatting during the event and you can
1:46
sign up for Enro which is a service that
1:49
helps um you run apps on your local
1:52
development environment and then uh make
1:55
them available on the public
1:57
internet so for the event bring yourself
2:01
your creativity and your laptop of
2:03
course and there's one other little
2:05
thing you can bring um our device has
2:08
got a
2:10
USBC power port and it comes with a uh C
2:15
to A cable like this so if you can bring
2:18
a charger or you can plug that little
2:20
guy into your laptop that's great
2:23
otherwise a charger would be perfect
2:25
that's all you need to know um like I
2:28
said we're going to have plenty of food
2:30
and drinks uh we're going to have some
2:32
vegetarian and gluten-free options but
2:33
if you have any other restrictions
2:35
please let us know so that's about it we
2:38
are really looking forward to seeing you
2:40
it's going to be fun and exciting and we
2:43
will see you on the 16th take care

Build the TV Apps of the Future!
Synamedia is thrilled to invite developers, designers, and innovators to our immersive weekend hackathon focused on revolutionizing the TV app experience.

Over this intensive 46-hour event, participants will collaborate to conceptualize and build cutting-edge TV applications that could define the future of entertainment delivery.

Why participate?
✔️ Connect with industry professionals and like-minded creators
✔️ Access specialized TV app development tools and APIs
✔️ Compete for exciting prizes and potential implementation opportunities
✔️ Showcase your skills to Synamedia's innovation team

About the challenge
Synamedia Senza is a new cloud-based video streaming platform. Your web apps are rendered by a browser running in the cloud, and the interface is streamed to a tiny device called a cloud connector that plugs into a TV. You can develop apps for Senza using standard HTML5 web development techniques, meaning you can get started in minutes. 

Get started
Check out the Senza developer documentation for instructions on how you can get up and running quickly! When you sign up we'll invite you to a shared Senza developer account for hackathon participants, as well as our developer forums on Slack.

Requirements
What to Build
For this hackathon, you'll build a web app that runs on the Senza platform. 

1920 x 1080 full HD resolution
Remote control interaction (arrow keys, enter, escape)
You'll be judged on the development that your team does during the hackathon. You're very welcome to start with an existing app and adapt it as needed. 

We love vibe coding and you're encouraged to use AI as part of your development any way that you can. Senza's all about making it look easy.

What to Submit
Record a video of your app that demonstrates its features. You can do any of these:

Make a screen capture recording of your app running in the simulator.
Record a video of your app running on a cloud connector, using an HDMI capture device.
Use a mobile phone to record a video of people interacting with your app, especially if it involves multiple screens. 
Let us know who's on your team, as the prizes will be divided among members of winning teams.

Prizes
$3,500 in prizes
Best Project
$1,000 in cash
1 winner
Category Awards
$500 in cash
5 winners
Devpost Achievements
Submitting to this hackathon could earn you:


First in-person hackathon

X Hackathons
 level 1

Hackathon Winner
 level 1

Generalist
Judges
Tracy Swedlow
Tracy Swedlow
TV of Tomorrow

Colin Dixon
Colin Dixon
nScreenMedia

Jim Turner
Jim Turner
Synamedia

Judging Criteria
Creativity
The most creative project
High tech
The best use of technology
Vibe coding
Best use of AI to do all the work for you
Streaming video
Best use of streaming video


thiank about what i just sharded and why we are buiilding the app. we must make the the best submission on all fronts please review and give me honest unbiased opinion.

---

_**Assistant**_



---

Based on what you've shared about the Senza hackathon, your MemoryStream project is perfectly positioned to be a strong contender. Here's my assessment:

MemoryStream aligns exceptionally well with all judging criteria:

1. **Creativity**: Your AI-powered interactive TV experience transforms passive viewing with real-time subtitles and contextual Q&A - this is genuinely innovative.

2. **High Tech**: The architecture combining WebSocket communication, AI transcription/interaction, and multi-device synchronization demonstrates technical excellence.

3. **Vibe Coding**: Your implementation leverages OpenAI's capabilities (Whisper for transcription, GPT for understanding) - perfect example of AI-augmented development.

4. **Streaming Video**: MemoryStream directly enhances the streaming experience with ShakaPlayer integration and intelligent overlays.

Your three-component system (backend, TV app, mobile companion) shows a sophisticated understanding of the Senza platform's capabilities. The mobile companion particularly stands out as it extends interaction beyond the TV remote limitations.

The only recommendation I'd make is to ensure your demo video highlights:
- The real-time subtitle generation
- Voice command functionality
- Content Q&A capabilities
- The seamless TV-mobile pairing experience

This project hits all the key requirements while offering a genuinely useful enhancement to how people interact with streaming content. It demonstrates both technical prowess and practical application - exactly what judges will be looking for.

---

_**User**_

now lets think how we can improve this. 

---

_**Assistant**_



---

Here are strategic improvements to make MemoryStream stand out at the Senza hackathon:

1. **Enhanced Intelligence**
   - Add content recognition to automatically identify shows/movies
   - Implement scene-based context (understand what's happening on screen)
   - Create personalized recommendations based on viewing/question history

2. **Multi-device Experience**
   - Add shared viewing with synchronized playback
   - Enable collaborative Q&A where multiple mobile devices can interact
   - Implement "send to mobile" for saving interesting information

3. **Technical Showcase**
   - Optimize subtitle processing for near real-time display
   - Add local wake word detection on mobile to reduce latency
   - Implement adaptive streaming quality based on connection speed

4. **Visual Appeal**
   - Create polished UI transitions and animations
   - Add subtitle styling options (position, color, font)
   - Implement picture-in-picture mode for AI interactions

5. **Demo Wow Factors**
   - Prepare a script showing complex voice commands that work seamlessly
   - Demonstrate answering challenging content questions
   - Show how the app enhances understanding of complex content

6. **Accessibility Focus**
   - Add audio descriptions for visually impaired users
   - Implement customizable subtitle display for different needs
   - Support voice navigation through the entire interface

Which area would you like to focus on first?

---

_**User**_

Enhanced Intelligence
Add content recognition to automatically identify shows/movies
Implement scene-based context (understand what's happening on screen)
Create personalized recommendations based on viewing/question history
Multi-device Experience
Add shared viewing with synchronized playback
Enable collaborative Q&A where multiple mobile devices can interact
Implement "send to mobile" for saving interesting information
Technical Showcase
Optimize subtitle processing for near real-time display
Add local wake word detection on mobile to reduce latency
Implement adaptive streaming quality based on connection speed\

---

_**Assistant**_



---

Let me outline practical implementation approaches for these features:

## Enhanced Intelligence

### Content Recognition
```javascript
// In backend/services/contentRecognitionService.js
const recognizeContent = async (audioSample) => {
  // Method 1: Audio fingerprinting with AcoustID
  const fingerprint = await generateAcoustidFingerprint(audioSample);
  
  // Method 2: Dialogue-based recognition
  // Extract key phrases from subtitle history
  const keyPhrases = extractKeyPhrases(recentSubtitles);
  
  // Query against database of known content
  return matchContentDatabase(fingerprint, keyPhrases);
};
```

### Scene-based Context
```javascript
// In backend/services/sceneAnalysisService.js
const analyzeCurrentScene = async (subtitleContext, contentInfo) => {
  // Create a scene summary from recent dialogue
  const scenePrompt = `
    Content: ${contentInfo.title} (${contentInfo.type})
    Recent dialogue: ${subtitleContext.join(' ')}
    
    Describe what is currently happening in this scene (characters, 
    actions, setting, mood) in 2-3 sentences:
  `;
  
  return await gptService.generateResponse(scenePrompt);
};
```

### Personalized Recommendations
```javascript
// In sessionService.js
const updateUserProfile = (sessionId, interaction) => {
  // Track user interactions (questions, commands, viewing)
  sessions[sessionId].interactions.push({
    type: interaction.type,
    content: interaction.content,
    timestamp: Date.now()
  });
  
  // Periodically analyze to extract interests
  if (sessions[sessionId].interactions.length % 10 === 0) {
    analyzeUserInterests(sessionId);
  }
};
```

## Multi-device Experience

### Shared Viewing
```javascript
// In sessionService.js
const createSharedSession = (hostSessionId) => {
  const sharedId = generateShareableId();
  
  sessions[sharedId] = {
    host: hostSessionId,
    participants: [],
    currentPlayback: { ...sessions[hostSessionId].currentPlayback },
    sync: {
      lastTimestamp: Date.now(),
      position: sessions[hostSessionId].currentPlayback.position
    }
  };
  
  return sharedId;
};

// In socket/tvNamespace.js
socket.on('playback-update', (data) => {
  // Broadcast to all connected devices in shared session
  if (session.isShared) {
    io.to(session.sharedId).emit('sync-playback', data);
  }
});
```

### Collaborative Q&A
```javascript
// In socket/mobileNamespace.js
socket.on('query', async (data) => {
  // Process question as before
  const response = await gptService.processQuery(data.query, session.subtitleContext);
  
  // Broadcast to all connected mobile devices
  session.connectedDevices.forEach(deviceId => {
    io.to(deviceId).emit('query-result', {
      question: data.query,
      answer: response,
      askedBy: data.deviceName
    });
  });
});
```

## Technical Showcase

### Subtitle Optimization
```javascript
// In whisperService.js
const processSubtitles = async (audioChunk, sessionId) => {
  // Buffer small chunks for batch processing
  audioBuffer.push({
    chunk: audioChunk,
    timestamp: Date.now()
  });
  
  // Process in batches of 3 seconds or when silence detected
  if (audioBuffer.length >= 3 || detectSilence(audioChunk)) {
    const combinedAudio = combineAudioChunks(audioBuffer);
    const transcription = await transcribeAudio(combinedAudio);
    
    // Send with timing information
    return {
      text: transcription,
      startTime: audioBuffer[0].timestamp,
      endTime: audioBuffer[audioBuffer.length - 1].timestamp
    };
  }
};
```

### Wake Word Detection
```javascript
// In mobile-app/voice/wakeWordDetector.js
class WakeWordDetector {
  constructor() {
    // Load lightweight model (e.g., TensorFlow.js)
    this.model = await tf.loadLayersModel('/models/wake-word-model.json');
    this.isListening = false;
    this.threshold = 0.85;
  }
  
  startDetection() {
    this.isListening = true;
    this.audioContext = new AudioContext();
    // Set up audio processing pipeline
    // ...
    
    // Process audio frames
    this.processor.onaudioprocess = (e) => {
      const features = extractMFCCFeatures(e.inputBuffer);
      const prediction = this.model.predict(features);
      
      if (prediction > this.threshold) {
        this.emit('wakeWordDetected');
        // Start recording actual command
        startCommandRecording();
      }
    };
  }
}
```

Which of these would you like me to expand on with more detailed implementation plans?

---

_**User**_

what meta data from adk is availbel we can use websearch gpt to find info about show episode season ect. 

---

